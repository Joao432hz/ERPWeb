{% extends "ui/base.html" %}
{% block title %}Compras · Alta de proveedor | ERPWeb{% endblock %}

{% block content %}
<div class="d-flex align-items-start justify-content-between gap-3 flex-wrap">
  <div>
    <h2 class="h4 mb-1">Compras · Alta de proveedor</h2>
    <p class="text-muted mb-0">El ID se genera automáticamente al guardar.</p>
  </div>
  <div>
    <a class="btn btn-outline-secondary" href="{% url 'ui:purchases_suppliers' %}">Volver</a>
  </div>
</div>

<form method="post" enctype="multipart/form-data" class="mt-3">
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger">{{ form.non_field_errors }}</div>
  {% endif %}

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Identificación y datos generales</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-6">
          <label class="form-label">Nombre legal / razón social</label>
          {{ form.name }}
          {% if form.name.errors %}<div class="text-danger small mt-1">{{ form.name.errors }}</div>{% endif %}
        </div>
        <div class="col-12 col-lg-6">
          <label class="form-label">Nombre comercial / corto</label>
          {{ form.trade_name }}
        </div>

        <div class="col-12 col-lg-4">
          <label class="form-label">Tipo de proveedor</label>
          {{ form.supplier_type }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Condición frente al IVA</label>
          {{ form.vat_condition }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">CUIT / NIF / Tax ID</label>
          {{ form.tax_id }}
        </div>

        <div class="col-12 col-lg-4">
          <label class="form-label">Tipo de documento</label>
          {{ form.document_type }}
        </div>

        <div class="col-12 col-lg-4">
          <label class="form-label">Estado del proveedor</label>
          {{ form.status }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Domicilios y ubicación</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-6">
          <label class="form-label">Dirección fiscal</label>
          {{ form.fiscal_address }}
        </div>
        <div class="col-12 col-lg-3">
          <label class="form-label">Provincia / Estado</label>
          {{ form.province }}
        </div>
        <div class="col-12 col-lg-3">
          <label class="form-label">Código postal</label>
          {{ form.postal_code }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">País</label>
          {{ form.country }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Contacto</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-4">
          <label class="form-label">Teléfono principal</label>
          {{ form.phone }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Teléfono secundario</label>
          {{ form.phone_secondary }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Fax / Web</label>
          {{ form.fax_or_web }}
        </div>

        <div class="col-12 col-lg-6">
          <label class="form-label">Email principal</label>
          {{ form.email }}
        </div>
        <div class="col-12 col-lg-6">
          <label class="form-label">Email compras / cobranzas</label>
          {{ form.email_ap }}
        </div>

        <div class="col-12 col-lg-6">
          <label class="form-label">Contacto principal (nombre)</label>
          {{ form.contact_name }}
        </div>
        <div class="col-12 col-lg-6">
          <label class="form-label">Cargo de contacto</label>
          {{ form.contact_role }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Condiciones comerciales</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-6">
          <div class="fw-semibold mb-2">{{ form.payment_terms.label }}</div>
          {{ form.payment_terms }}
        </div>
        <div class="col-12 col-lg-6">
          <div class="fw-semibold mb-2">{{ form.standard_payment_terms.label }}</div>
          {{ form.standard_payment_terms }}
        </div>

        <div class="col-12 col-lg-4">
          <label class="form-label">Frecuencia actualización lista (días)</label>
          {{ form.price_list_update_days }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Moneda de transacción</label>
          {{ form.transaction_currency }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Cuenta corriente acreedora activa</label>
          {{ form.account_reference }}
        </div>

        <div class="col-12 col-lg-6">
          <label class="form-label">Clasificación / sector</label>
          {{ form.classification }}
        </div>
        <div class="col-12 col-lg-6">
          <label class="form-label">Categoría productos del proveedor</label>
          {{ form.product_category }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Datos bancarios</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-4">
          <label class="form-label">Banco</label>
          {{ form.bank_name }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Sucursal / CBU / IBAN</label>
          {{ form.bank_account_ref }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Tipo de cuenta</label>
          {{ form.bank_account_type }}
        </div>

        <div class="col-12 col-lg-6">
          <label class="form-label">Titular</label>
          {{ form.bank_account_holder }}
        </div>
        <div class="col-12 col-lg-6">
          <label class="form-label">Moneda de cuenta</label>
          {{ form.bank_account_currency }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Gestión tributaria y cumplimiento</h3>
      <div class="row g-3">
        <div class="col-12 col-lg-4">
          <label class="form-label">Condición tributaria</label>
          {{ form.tax_condition }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Categoría retención IVA/Ganancias</label>
          {{ form.retention_category }}
        </div>
        <div class="col-12 col-lg-4">
          <label class="form-label">Códigos de retenciones aplicables</label>
          {{ form.retention_codes }}
        </div>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Otros datos</h3>
      <div class="row g-3">
        <div class="col-12">
          <label class="form-label">Notas internas / observaciones</label>
          {{ form.internal_notes }}
        </div>

        <div class="col-12">
          <label class="form-label">{{ form.documents.label }}</label>
          {{ form.documents }}
          <div class="small text-muted mt-1">Tipos: PDF/DOC/DOCX/JPG/BMP/PNG</div>
        </div>

        <div class="col-12">
          <label class="form-label">{{ form.extra_fields_text.label }}</label>
          {{ form.extra_fields_text }}
          <div class="small text-muted mt-1">MVP: se guarda como JSON key/value.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex gap-2">
    <button class="btn btn-success">Guardar proveedor</button>
    <a class="btn btn-outline-secondary" href="{% url 'ui:purchases_suppliers' %}">Cancelar</a>
  </div>
</form>
{% endblock %}
